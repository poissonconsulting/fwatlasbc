<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Freshwater Atlas British Columbia • fwatlasbc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Freshwater Atlas British Columbia">
<meta property="og:description" content="What the package does (one paragraph).">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">fwatlasbc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1.9018</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="fwatlasbc-">fwatlasbc <img src="reference/figures/logo.png" align="right"><a class="anchor" aria-label="anchor" href="#fwatlasbc-"></a>
</h1></div>
<!-- badges: start -->

<p><code>fwatlasbc</code> is an R package for querying data from the <a href="https://www2.gov.bc.ca/gov/content/data/geographic-data-services/topographic-data/freshwater" class="external-link">Freshwater Atlas</a> (FWA) of British Columbia. Spatial data are returned as <a href="https://github.com/r-spatial/sf" class="external-link">simple features</a>.</p>
<p><code>fwatlasbc</code> wraps <a href="https://github.com/poissonconsulting/fwapgr" class="external-link"><code>fwapgr</code></a> an R package that uses the <a href="https://www.hillcrestgeo.ca/fwapg/index.html" class="external-link">fwapg API</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest version of <code>fwatlasbc</code> from <a href="https://github.com/poissonconsulting/fwatlasbc" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"poissonconsulting/fwatlasbc"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="demonstration">Demonstration<a class="anchor" aria-label="anchor" href="#demonstration"></a>
</h2>
<p>Find stream names using regular expression. There may be more than one stream name that matches the regular expression.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">fwatlasbc</span><span class="op">)</span></span>
<span><span class="va">streams</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fwa_find_stream_names.html">fwa_find_stream_names</a></span><span class="op">(</span><span class="st">"steep c"</span><span class="op">)</span></span>
<span><span class="va">streams</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 1</span></span>
<span><span class="co">#&gt;   stream_name       </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;             </span></span>
<span><span class="co">#&gt; 1 Steep Canyon Creek</span></span>
<span><span class="co">#&gt; 2 Steep Creek</span></span></code></pre></div>
<p>Add blue line keys (blk) to stream names. There may be multiple streams with the same name.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fwa_add_blks_to_stream_name.html">fwa_add_blks_to_stream_name</a></span><span class="op">(</span><span class="va">streams</span><span class="op">)</span></span>
<span><span class="va">blks</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 2</span></span>
<span><span class="co">#&gt;   stream_name              blk</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                  &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Steep Canyon Creek 360883036</span></span>
<span><span class="co">#&gt; 2 Steep Creek        356362258</span></span>
<span><span class="co">#&gt; 3 Steep Creek        356534225</span></span>
<span><span class="co">#&gt; 4 Steep Creek        356570155</span></span>
<span><span class="va">blks</span> <span class="op">&lt;-</span> <span class="va">blks</span><span class="op">[</span><span class="va">blks</span><span class="op">$</span><span class="va">blk</span> <span class="op">==</span> <span class="fl">356534225</span>,<span class="op">]</span></span></code></pre></div>
<p>Alternatively get the nearest blue line key and river meter (rm) from the longitude and latitude. The river meter is the distance in meters as the fish swims from the mouth of the river. The distance_to_lon_lat is the how far the original point was from the stream in meters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/fwa_add_blk_to_lon_lat.html">fwa_add_blk_to_lon_lat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="op">-</span><span class="fl">132.26</span>, lat <span class="op">=</span> <span class="fl">53.36</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 5 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 585153.6 ymin: 946162.9 xmax: 585153.6 ymax: 946162.9</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / BC Albers</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 6</span></span>
<span><span class="co">#&gt;     lon   lat       blk    rm distance_to_lon_lat            geometry</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;               &lt;dbl&gt;         &lt;POINT [m]&gt;</span></span>
<span><span class="co">#&gt; 1 -132.  53.4 360824839 1118.                508. (585153.6 946162.9)</span></span></code></pre></div>
<p>Get watershed (by aggregating fundamental watersheds) for a blue line key and river meter (by default 0). If it errors try increasing the river meter.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wshed</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fwa_add_watershed_to_blk.html">fwa_add_watershed_to_blk</a></span><span class="op">(</span><span class="va">blks</span><span class="op">)</span></span>
<span><span class="va">wshed</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 1656218 ymin: 725423.1 xmax: 1661726 ymax: 732146.2</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / BC Albers</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span><span class="co">#&gt;   stream_name       blk    rm                                           geometry</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt;                                      &lt;POLYGON [m]&gt;</span></span>
<span><span class="co">#&gt; 1 Steep Creek 356534225     0 ((1658107 728964.9, 1658107 728964.9, 1658179 728…</span></span></code></pre></div>
<p>Get stream network for the watershed polygon. Note that rm is from the original watershed while downstream/upstream_route_measure are the equivalents for the stream segment in the network.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fwa_add_collection_to_polygon.html">fwa_add_collection_to_polygon</a></span><span class="op">(</span><span class="va">wshed</span>, <span class="st">"stream_network"</span><span class="op">)</span></span>
<span><span class="va">network</span></span>
<span><span class="co">#&gt; Simple feature collection with 76 features and 31 fields</span></span>
<span><span class="co">#&gt; Geometry type: LINESTRING</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 1656200 ymin: 725423.1 xmax: 1661368 ymax: 731602.7</span></span>
<span><span class="co">#&gt; Projected CRS: NAD83 / BC Albers</span></span>
<span><span class="co">#&gt; # A tibble: 76 × 32</span></span>
<span><span class="co">#&gt;    stream…¹    blk    rm blue_…² blue_…³ downs…⁴ edge_…⁵ featu…⁶ featu…⁷ fwa_w…⁸</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  </span></span>
<span><span class="co">#&gt;  1 Steep C… 3.57e8     0  3.57e8    1130  2931.     1250 WA2411… areal … 300-90…</span></span>
<span><span class="co">#&gt;  2 Steep C… 3.56e8     0  3.56e8      NA  1110.     1000 GA2485… linear… 300-90…</span></span>
<span><span class="co">#&gt;  3 Steep C… 3.57e8     0  3.57e8      NA     0      1000 GA2485… linear… 300-90…</span></span>
<span><span class="co">#&gt;  4 Steep C… 3.57e8     0  3.57e8    1142  2594.     1000 GA2485… linear… 300-90…</span></span>
<span><span class="co">#&gt;  5 Steep C… 3.57e8     0  3.57e8    1142  2251.     1000 GA2485… linear… 300-90…</span></span>
<span><span class="co">#&gt;  6 Steep C… 3.56e8     0  3.56e8      NA     0      1000 GA2485… linear… 300-90…</span></span>
<span><span class="co">#&gt;  7 Steep C… 3.56e8     0  3.56e8      NA     0      1000 GA2485… linear… 300-90…</span></span>
<span><span class="co">#&gt;  8 Steep C… 3.57e8     0  3.57e8    1131    51.8    1000 GA2485… linear… 300-90…</span></span>
<span><span class="co">#&gt;  9 Steep C… 3.57e8     0  3.57e8    1130   751.     1250 WA2411… areal … 300-90…</span></span>
<span><span class="co">#&gt; 10 Steep C… 3.56e8     0  3.56e8      NA   346.     1000 GA2485… linear… 300-90…</span></span>
<span><span class="co">#&gt; # … with 66 more rows, 22 more variables: gnis_id &lt;dbl&gt;, gnis_name &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   gradient &lt;dbl&gt;, left_right_tributary &lt;chr&gt;, length_metre &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   linear_feature_id &lt;dbl&gt;, local_watershed_code &lt;chr&gt;, localcode_ltree &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   stream_magnitude &lt;dbl&gt;, stream_order &lt;dbl&gt;, stream_order_max &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   stream_order_parent &lt;dbl&gt;, upstream_route_measure &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   waterbody_key &lt;dbl&gt;, watershed_code_50k &lt;chr&gt;, watershed_group_code &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   watershed_group_code_50k &lt;chr&gt;, watershed_group_id &lt;dbl&gt;, …</span></span></code></pre></div>
<p>Convert the stream network into a table of blue line keys with regularly spaced river meters starting at 0.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#rms &lt;- fwa_convert_stream_network_to_rms(network, interval = 100)</span></span>
<span><span class="co">#rms</span></span></code></pre></div>
<p>Plot the watershed, network and river meters.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wshed</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">network</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="co">#  ggplot2::geom_sf(data = rms) +</span></span>
<span>  <span class="cn">NULL</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="inspiration">Inspiration<a class="anchor" aria-label="anchor" href="#inspiration"></a>
</h2>
<p><code>fwatlasbc</code> supersedes the archived <a href="https://github.com/poissonconsulting/fwabc" class="external-link"><code>fwabc</code></a> which retrieved data via <a href="https://openmaps.gov.bc.ca/geo/pub/wfs?service=WFS&amp;version=2.0.0&amp;request=GetFeature&amp;typeName=WHSE_BASEMAPPING.FWA_LAKES_POLY&amp;outputFormat=json&amp;SRSNAME=epsg%3A3005&amp;CQL_FILTER=GNIS_NAME_1=%27Quamichan%20Lake%27" class="external-link">WFS</a> using <a href="https://github.com/bcgov/bcdata" class="external-link"><code>bcdata</code></a>.</p>
</div>
<div class="section level2">
<h2 id="creditation">Creditation<a class="anchor" aria-label="anchor" href="#creditation"></a>
</h2>
<p><code>fwatlasbc</code> relies on <a href="https://www.hillcrestgeo.ca/fwapg/index.html" class="external-link">fwapg API</a> which is created, maintained and hosted by <a href="https://github.com/smnorris/fwapg" class="external-link">Simon Norris</a> at <a href="https://hillcrestgeo.ca/main/" class="external-link">Hillcrest Geographics</a>.</p>
</div>
<div class="section level2">
<h2 id="contribution">Contribution<a class="anchor" aria-label="anchor" href="#contribution"></a>
</h2>
<p>Please report any <a href="https://github.com/poissonconsulting/fwatlasbc/issues" class="external-link">issues</a>.</p>
<p><a href="https://github.com/poissonconsulting/fwatlasbc/pulls" class="external-link">Pull requests</a> are always welcome.</p>
<div class="section level3">
<h3 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h3>
<p>Please note that <code>fwatlasbc</code> is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fwatlasbc</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Joe Thorley <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/https://orcid.org/0000-0002-7683-4592" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Sebastian Dalgarno <br><small class="roles"> Author </small> <a href="https://orcid.org/https://orcid.org/0000-0002-3658-4517" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Poisson Consulting <br><small class="roles"> Copyright holder, funder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/poissonconsulting/fwatlasbc/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/poissonconsulting/fwatlasbc/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/poissonconsulting/fwatlasbc" class="external-link"><img src="https://codecov.io/gh/poissonconsulting/fwatlasbc/branch/main/graph/badge.svg?token=x3TrvhuMbK" alt="codecov"></a></li>
<li><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-green.svg" alt="License: MIT"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Joe Thorley, Sebastian Dalgarno, Poisson Consulting.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
